from collections import defaultdict

def countSubstringsWithKDistinct(s: str, k: int) -> int:
    def atMostK(s: str, k: int) -> int:
        count = defaultdict(int)
        left = 0
        result = 0
        distinct = 0   
        for right in range(len(s)):
            if count[s[right]] == 0:
                distinct += 1
            count[s[right]] += 1     
            while distinct > k:
                count[s[left]] -= 1
                if count[s[left]] == 0:
                    distinct -= 1
                left += 1 
            result += (right - left + 1)
        return result
    return atMostK(s, k) - atMostK(s, k - 1)

print(countSubstringsWithKDistinct("pqpqs", 2))       
print(countSubstringsWithKDistinct("aabacbebebe", 3))
print(countSubstringsWithKDistinct("a", 1))           
print(countSubstringsWithKDistinct("abc", 3))         
print(countSubstringsWithKDistinct("abc", 2))         
